{% load static %}
{% load library_tags %}

{% if categories_data %}
<section class="bg-neo-white border-4 border-neo-black shadow-neo p-8 mb-8">
  <h2 class="text-3xl font-black text-neo-black mb-6 uppercase">
    Outils associés
  </h2>
  
  {% for category in categories_data %}
    {% if category.libraries %}
    <div class="mb-8">
      <!-- Titre de catégorie -->
      <h3 class="text-xl font-black text-neo-black mb-4 uppercase border-b-2 border-neo-black pb-2">
        {{ category.title }}
      </h3>
      
      <!-- Grille des outils -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for library in category.libraries %}
        <div class="border-4 border-neo-black bg-neo-white p-6 hover:-translate-y-1 transition-all duration-200 shadow-neo hover:shadow-neo-hover">
          
          <!-- Nom de l'outil -->
          <h4 class="text-lg font-black text-neo-black mb-3">
            {{ library|display_library_name }}
          </h4>
          
          <!-- Description -->
          <p class="text-sm text-neo-black mb-4 leading-relaxed">
            {% if category.key == 'uncategorized' %}
              {{ library.technology_type }}: {{ library.description|truncatechars:80|default:"Outil pour "|add:language.name }}
            {% else %}
              {{ library.description|truncatechars:80|default:category.default_desc|add:" "|add:language.name }}
            {% endif %}
          </p>
          
          <!-- Métadonnées -->
          <div class="flex justify-between items-center text-xs">
            <span class="px-2 py-1 bg-pokedev-yellow border-2 border-neo-black font-bold">
              {{ library.technology_type }}
            </span>
            {% if library.is_open_source %}
            <span class="px-2 py-1 bg-green-400 border-2 border-neo-black font-bold">
              Open Source
            </span>
            {% endif %}
          </div>
          
          <!-- Lien vers l'outil (quand l'app tools existera) -->
          {% comment %}
          <div class="mt-4">
            <a href="{% url 'tools:detail' library.slug %}" 
               class="inline-block px-4 py-2 bg-neo-black text-pokedev-yellow border-4 border-neo-black font-black hover:bg-pokedev-yellow hover:text-neo-black transition-all duration-200">
              Voir détails
            </a>
          </div>
          {% endcomment %}
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  {% endfor %}
</section>

{% else %}
<!-- Aucun outil trouvé -->
<section class="bg-neo-white border-4 border-neo-black shadow-neo p-8 mb-8">
  <h2 class="text-3xl font-black text-neo-black mb-6 uppercase">
    Outils associés
  </h2>
  
  <div class="bg-gray-100 border-4 border-neo-black p-6 text-center">
    <p class="font-bold text-neo-black">
      Aucun outil associé trouvé pour {{ language.name }}.
    </p>
  </div>
</section>
{% endif %}
